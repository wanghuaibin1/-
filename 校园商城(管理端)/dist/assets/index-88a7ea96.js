import{d as Z,r as _,p as d,h as i,o as ee,c as te,s as t,k as s,m as V,a6 as h,a7 as le,l as u,a as c,t as z,F as ae,K as se,a8 as oe,a4 as C}from"./index-ff0f60b8.js";import{p as ne,a as re}from"./business-704d43c4.js";import{r as I}from"./request-512292d2.js";const ie=m=>I.get("/adminUser/page",m),ue=m=>I.get("/adminUser/byName",m),de=m=>I.delete("/adminUser/delete",m),ce={class:"flex"},pe={class:"w-1/2 h-[100px]"},me=c("div",{class:"image-slot"},[u("Loading"),c("span",{class:"dot"},"...")],-1),fe={class:"w-1/2 h-[100px] flex items-center justify-center"},ge={class:"dialog-footer"},Ce=Z({__name:"index",setup(m){const{proxy:A}=se(),f=_({name:"",productID:""}),F=d(),k=_({list:[{productId:17,productName:"骚炳的腰子",productDescription:"一个虚弱的腰子",price:.01,imgUrl:"http://www.javacg.icu:7742/img/6f5b5f08-a345-4551-abb4-62568b4b7f76.jpg",storeId:1,stockQuantity:2,productStatus:"上架",createTime:"2023-10-09T20:14:51.000+00:00"}]}),D=async()=>{if(f.name.length===0)return;const{data:a}=await ue({name:f.name});k.list=[],a.value!==""&&k.list.push(a.value)},Q=()=>{f.name="",y.value=1,b.value=5,p()},T=_({list:[]}),q=a=>{T.list=a},y=d(1),b=d(5),j=d(!1),B=d(!1),N=_({zo:200}),$=a=>{b.value=a,p()},M=a=>{y.value=a,p()},p=async()=>{const{data:a}=await ie({yema:y.value,count:b.value});k.list=a.value.records,N.zo=a.value.total};p();const K=a=>{oe.confirm("确定要删除商品吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{const{data:e}=await de({id:a.userId});if(console.log(e),e.value){C({type:"success",message:"删除成功"}),p();return}C.error("删除失败")}).catch(()=>{C({type:"info",message:"已取消"})})},R=async a=>{o.list=a,g.value=!0,x.value="修改"},x=d(""),w=d(),Y=_({productName:[{required:!0,message:"请填写商品名称",trigger:"blur"}],productStatus:[{required:!0,message:"请选择商品状态",trigger:"change"}],price:[{required:!0,validator:(a,e,n)=>{e===0?n(new Error("请填写商品价格")):n()},trigger:"change"}],stockQuantity:[{required:!0,validator:(a,e,n)=>{e===0?n(new Error("请填写商品库存")):n()},trigger:"change"}],productDescription:[{required:!0,message:"请填写商品描述",trigger:"blur"}]}),g=d(!1),o=_({list:{productId:"",productName:"",productStatus:"",price:"",stockQuantity:"",productDescription:""}}),E=async a=>{a&&await a.validate(async(e,n)=>{if(e){if(x.value==="发布"){const{data:r}=await ne({productName:o.list.productName,productDescription:o.list.productDescription,price:o.list.price,imgUrl:"",storeId:0,stockQuantity:o.list.stockQuantity,productStatus:o.list.productStatus,createTime:new Date});r.value&&(p(),C({type:"success",message:"添加成功"}),g.value=!1,a.resetFields())}else if(x.value==="修改"){const{data:r}=await re({productId:o.list.productId,productName:o.list.productName,productDescription:o.list.productDescription,price:o.list.price,imgUrl:"",storeId:0,stockQuantity:o.list.stockQuantity,productStatus:o.list.productStatus,createTime:new Date});r.value&&(p(),C({type:"success",message:"修改成功"}),g.value=!1,a.resetFields())}}else console.log("error submit!",n)})},H=a=>{a&&a.resetFields()};return(a,e)=>{const n=i("el-form-item"),r=i("el-button"),S=i("el-form"),v=i("el-table-column"),J=i("el-image"),L=i("el-table"),G=i("el-pagination"),U=i("el-option"),O=i("el-select"),P=i("el-input-number"),W=i("el-dialog");return ee(),te(ae,null,[t(S,{inline:!0,model:f,class:"demo-form-inline"},{default:s(()=>[t(n,{label:"用户名称"},{default:s(()=>[t(V(h),{onKeyup:le(D,["enter"]),modelValue:f.name,"onUpdate:modelValue":e[0]||(e[0]=l=>f.name=l),placeholder:"输入后回车搜索",clearable:""},null,8,["onKeyup","modelValue"])]),_:1}),t(n,null,{default:s(()=>[t(r,{type:"primary",onClick:D},{default:s(()=>[u("搜索")]),_:1}),t(r,{type:"success",onClick:Q},{default:s(()=>[u("重置")]),_:1})]),_:1})]),_:1},8,["model"]),c("div",null,[c("div",null,[t(L,{ref_key:"tableRef",ref:F,"row-key":"date",data:k.list,style:{width:"100%"},border:"","cell-style":{textAlign:"center"},"header-cell-style":{"text-align":"center"},onSelectionChange:q},{default:s(()=>[t(v,{type:"selection",width:"40"}),t(v,{prop:"userName",label:"用户",width:"300"},{default:s(l=>[c("div",ce,[c("div",pe,[t(J,{style:{width:"6.25rem",height:"6.25rem"},"preview-src-list":"",src:"http://www.javacg.icu:7742/img/6f5b5f08-a345-4551-abb4-62568b4b7f76.jpg",fit:"cover"},{placeholder:s(()=>[me]),_:1})]),c("div",fe,z(l.row.userName)+" ",1)])]),_:1}),t(v,{prop:"phoneNumber",label:"手机号"}),t(v,{prop:"address",label:"收货地址"}),t(v,{prop:"createTime",label:"创建时间",sortable:""},{default:s(l=>[u(z(V(A).$dayjs(l.row.CreateTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),t(v,{label:"操作"},{default:s(({row:l})=>[t(r,{type:"danger",onClick:X=>K(l)},{default:s(()=>[u("删除")]),_:2},1032,["onClick"]),t(r,{type:"success",onClick:X=>R(l)},{default:s(()=>[u("修改")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(G,{class:"mt-6","current-page":y.value,"onUpdate:currentPage":e[1]||(e[1]=l=>y.value=l),"page-size":b.value,"onUpdate:pageSize":e[2]||(e[2]=l=>b.value=l),"page-sizes":[5,10,15,20],disabled:B.value,background:j.value,layout:"total, sizes, prev, pager, next, jumper",total:N.zo,onSizeChange:$,onCurrentChange:M},null,8,["current-page","page-size","disabled","background","total"])])]),t(W,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=l=>g.value=l),title:"商品信息",width:"50%",center:"","align-center":"",onClose:e[12]||(e[12]=l=>w.value.resetFields())},{footer:s(()=>[c("span",ge,[t(r,{onClick:e[10]||(e[10]=l=>(g.value=!1,w.value.resetFields()))},{default:s(()=>[u("取消")]),_:1})])]),default:s(()=>[t(S,{inline:!0,model:o.list,"label-position":"right",size:"large",rules:Y,ref_key:"ruleFormRef",ref:w},{default:s(()=>[t(n,{label:"商品名称",prop:"productName",class:"w-full !mr-0"},{default:s(()=>[t(V(h),{modelValue:o.list.productName,"onUpdate:modelValue":e[3]||(e[3]=l=>o.list.productName=l),placeholder:"商品名称",clearable:""},null,8,["modelValue"])]),_:1}),t(n,{label:"商品状态",prop:"productStatus",class:"w-full !mr-0"},{default:s(()=>[t(O,{class:"w-full",modelValue:o.list.productStatus,"onUpdate:modelValue":e[4]||(e[4]=l=>o.list.productStatus=l),placeholder:"请选择商品状态",clearable:""},{default:s(()=>[t(U,{label:"已上架",value:"已上架"}),t(U,{label:"未上架",value:"未上架"})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"商品价格",prop:"price",class:"w-1/2 !mr-0"},{default:s(()=>[t(P,{modelValue:o.list.price,"onUpdate:modelValue":e[5]||(e[5]=l=>o.list.price=l),precision:1,step:.5,max:999,min:0},null,8,["modelValue"])]),_:1}),t(n,{label:"商品库存",prop:"stockQuantity",class:"w-1/2 !mr-0"},{default:s(()=>[t(P,{modelValue:o.list.stockQuantity,"onUpdate:modelValue":e[6]||(e[6]=l=>o.list.stockQuantity=l),min:0,step:1,"step-strictly":""},null,8,["modelValue"])]),_:1}),t(n,{label:"商品描述",prop:"productDescription",class:"w-full !mr-0"},{default:s(()=>[t(V(h),{modelValue:o.list.productDescription,"onUpdate:modelValue":e[7]||(e[7]=l=>o.list.productDescription=l),type:"textarea"},null,8,["modelValue"])]),_:1}),t(n,null,{default:s(()=>[t(r,{type:"primary",onClick:e[8]||(e[8]=l=>E(w.value))},{default:s(()=>[u(" 确定 ")]),_:1}),t(r,{onClick:e[9]||(e[9]=l=>H(w.value))},{default:s(()=>[u("重置")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}});export{Ce as default};
